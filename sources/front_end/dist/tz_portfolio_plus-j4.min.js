!function(t,e,o){"use strict";function r(t,e,o){return o&&"auto"!=o||!t.last().attr("data-order")||!t.last().data("order").toString().length||(o="filter_asc"),t.sort(function(t,e){var r=jQuery(t).data("order")?parseInt(jQuery(t).data("order"),10):jQuery(t).text().trim(),a=jQuery(e).data("order")?parseInt(jQuery(e).data("order"),10):jQuery(e).text().trim();if("*"!=jQuery(t).attr("data-option-value")&&"*"!=jQuery(e).attr("data-option-value")){if("asc"==o.substr(o.length-3,o.length).toLowerCase())return r<a?-1:r>a?1:0;if("desc"==o.substr(o.length-4,o.length).toLowerCase())return r>a?-1:r<a?1:0}}),t.each(function(t,o){e.append(o).append("\n")}),!0}o.infiniteScroll={addAjaxComplete:function(t){this.ajaxCompletes.push(t)},ajaxCompletes:[]},t.tzPortfolioPlusIsotope=function(o,a){var i=t(o),n=t.extend(!0,{},t.tzPortfolioPlusIsotope.defaults),s=t.extend(!0,n,a);s.params.orderby_sec.length||(s.params.orderby_sec="rdate");var l=s.params,d=s.isotope_options;switch(l.orderby_sec){default:d.core.sortBy="original-order",d.core.sortAscending=!0;break;case"order":case"rorder":d.core.sortBy="original-order",d.core.sortAscending=!0;break;case"date":d.core.sortBy="date",d.core.sortAscending=!0,s.timeline&&(d.core.sortAscending=!1);break;case"rdate":d.core.sortBy="date",d.core.sortAscending=!1;break;case"alpha":d.core.sortBy="name",d.core.sortAscending=!0;break;case"ralpha":d.core.sortBy="name",d.core.sortAscending=!1;break;case"author":case"rauthor":d.core.sortBy="date",d.core.sortAscending=!1;break;case"hits":d.core.sortBy="hits",d.core.sortAscending=!1;break;case"rhits":d.core.sortBy="hits",d.core.sortAscending=!0}return d.core.layoutMode.length||(l.layout_type.length?d.core.layoutMode=l.layout_type[0]:d.core.layoutMode="masonry"),i.tz_init=function(e){var o,a,n=t(s.mainElementSelector).width(),c=l.tz_column_width,f=0,u=0,p=0;n<i.width()&&(n=i.width()),s.columnWidth&&(c=s.columnWidth),s.timeline&&t.extend(!0,t.Isotope.prototype,{_sort:function(){var e=this.options.sortBy,o=this._getSorter,r=this.options.sortAscending?1:-1;this.$filteredAtoms.sort(function(a,i){var n=o(a,e),s=o(i,e);if(n===s&&"original-order"!==e&&(n=o(a,"original-order"),s=o(i,"original-order")),"name"==e||"hits"==e){if(t(a).attr("data-category")>t(i).attr("data-category"))return 0;if(t(a).attr("data-category")==t(i).attr("data-category"))return t(a).hasClass("TzDate")?0:n>s?1*r:0}return(n>s?1:n<s?-1:0)*r})}}),o=Math.floor(n/c),s.beforeCalculateColumn(o),u=n,p=n,(f=(a=o+1)-n/c>n/c-o?o:a)>1&&(p=2*(u=Math.floor(n/f))),s.afterCalculateColumn(f,u),i.find(".element").width(u),i.find(s.elementFeatureSelector).width(p),i.find(".element").find(".element.TzDate").width(n),s.afterColumnWidth(f,u),e&&i.find(".element").css({opacity:0}),i.imagesLoaded(function(){s.afterImagesLoaded(),e&&i.find(".element").css({opacity:1}),i.isotope({resizable:!1,itemSelector:d.core.itemSelector,layoutMode:d.core.layoutMode,sortBy:d.core.sortBy,sortAscending:d.core.sortAscending,filter:d.core.filter,masonry:{columnWidth:u},getSortData:d.core.getSortData},function(){parseInt(l.tz_show_filter,10)&&l.filter_tags_categories_order&&r(t(d.sortParentTag).find(d.sortChildTag),t(d.sortParentTag),l.filter_tags_categories_order),d.complete()})})},i.loadPortfolio=function(){var o=t(d.filterSelector).find(d.tagFilter),r=null,a=d.core;o.click(function(o){o.preventDefault();var n=t(this);if(n.hasClass("selected"))return!1;var s=n.parents(".option-set");s.find(".selected").removeClass("selected"),n.addClass("selected");var d=a,c=s.attr("data-option-key"),f=n.attr("data-option-value");return f="false"!==f&&f,d[c]=f,"layoutMode"===c&&"function"==typeof e.changeLayoutMode?e.changeLayoutMode(n,d):("name"==f&&("alpha"==l.orderby_sec||"alpha"!=l.orderby_sec&&"ralpha"!=l.orderby_sec?d.sortAscending=!0:"ralpha"==l.orderby_sec&&(d.sortAscending=!1)),"date"==f&&("rdate"==l.orderby_sec||"date"!=l.orderby_sec&&"rdate"!=l.orderby_sec?d.sortAscending=!1:"date"==l.orderby_sec&&(d.sortAscending=!0)),"hits"==f&&("hits"==l.orderby_sec||"hits"!=l.orderby_sec&&"rhits"!=l.orderby_sec?d.sortAscending=!1:"rhits"==l.orderby_sec&&(d.sortAscending=!0)),d=t.extend(r,d),i.isotope(d),r=d),!1})},i.tz_init(!0),t(d.filterSelector+"[data-option-key=sortBy]").children().removeClass("selected").end().find("[data-option-value="+d.core.sortBy+"]").addClass("selected"),i.loadPortfolio(),i.vars=s,t.data(o,"tzPortfolioPlusIsotope",i),t(e).smartresize(function(){i.tz_init()}),this},t.tzPortfolioPlusIsotope.defaults={columnWidth:"",mainElementSelector:"#TzContent",containerElementSelector:"#portfolio",elementFeatureSelector:".tz_feature_item",JSON:{},timeline:!1,params:{orderby_sec:"rdate",tz_show_filter:1,filter_tags_categories_order:"auto",tz_portfolio_plus_layout:"ajaxButton",comment_function_type:"default",tz_filter_type:"categories",show_all_filter:0,tz_comment_type:"disqus",tz_show_count_comment:1,tz_column_width:233,layout_type:["masonry"]},isotope_options:{core:{itemSelector:".element",layoutMode:"",sortBy:"date",sortAscending:!1,filter:"*",getSortData:{date:function(t){var e=t.hasClass("element")&&t.attr("data-date").length?t.attr("data-date"):t.find(".create").text();return parseInt(e,10)},hits:function(t){var e=t.hasClass("element")&&t.attr("data-hits").length?t.attr("data-hits"):t.find(".hits,.tpp-item-hit").text();return parseInt(e,10)},name:function(t){var e=t.hasClass("element")&&t.find(".TzPortfolioTitle.name,.tpp-item-title.name").length?t.find(".TzPortfolioTitle.name, .tpp-item-title.name").text().trim():t.attr("data-title").length?t.attr("data-title"):"";return e.length?e:t.text().trim()}}},filterSelector:"#tz_options .option-set",tagFilter:"a",sortParentTag:"#filter",sortChildTag:"a",complete:function(){}},beforeCalculateColumn:function(){},afterCalculateColumn:function(){},afterColumnWidth:function(){},afterImagesLoaded:function(){}},t.fn.tzPortfolioPlusIsotope=function(e){if(void 0===e&&(e={}),"object"==typeof e)return this.each(function(){void 0===t(this).data("tzPortfolioPlusIsotope")?new t.tzPortfolioPlusIsotope(this,e):t(this).data("tzPortfolioPlusIsotope")})},t.tzPortfolioPlusInfiniteScroll=function(a,i){var n=t(a),s=t.extend(!0,t.tzPortfolioPlusInfiniteScroll.defaults,i),l=s.params,d=!0,c=t("div.TzDate:last").attr("data-category");n.infinitescroll({navSelector:s.navSelector,nextSelector:s.nextSelector,itemSelector:s.itemSelector,dataType:s.dataType,template:function(e){if(e){if(e.filter){var o=(o=t(e.filter)).map(function(){if(-1==t(s.sortParentTag).find(s.sortChildTag+'[data-option-value="'+t(this).data("option-value")+'"]').index())return this});t(s.sortParentTag).append(o),n.data("tzPortfolioPlusIsotope").loadPortfolio(),r(t(s.sortParentTag).find(s.sortChildTag),t(s.sortParentTag),l.filter_tags_categories_order)}return e.articles}},errorCallback:function(){s.errorCallback||(l.tz_portfolio_plus_layout&&"ajaxButton"!=l.tz_portfolio_plus_layout||t("#tz_append a").unbind("click").html(s.loadedText).show(),"ajaxInfiScroll"==l.tz_portfolio_plus_layout&&t("#tz_append").removeAttr("style").html('<a class="tzNomore">'+s.loadedText+"</a>"),t("#tz_append a").addClass("tzNomore"),t("#infscr-loading").css("display","none"))},loading:{msgText:s.msgText,finishedMsg:"",img:"",selector:"#tz_append"}},function(e,r,a){var i=e;if(e){if(e.articles&&!r.appendCallback){var l=t("<div/>");l.append(e.articles),i=l.children().get(),n.append(i)}t("#infscr-loading").css("display","none");var f=t(i).css({opacity:0});f.imagesLoaded(function(){f.animate({opacity:1});var a=n.data("tzPortfolioPlusIsotope");if(a.tz_init(),s.timeline)a.isotope("insert",f),f.each(function(){if(t(this).attr("class").match(/.*?TzDate.*?/i)){var e=t(this).attr("data-category");c==e?(t(this).remove(),a.isotope("reloadItems")):c=e}});else if(a.isotope("appended",f),e.filter&&!r.appendCallback){var i=(i=t(e.filter)).map(function(){if(-1==t(s.sortParentTag).find(s.sortChildTag+'[data-option-value="'+t(this).data("option-value")+'"]').index())return this});t(s.sortParentTag).append(i),a.loadPortfolio()}0,d=!0,f.length&&t("div#tz_append").find("a:first").show(),o.infiniteScroll.ajaxCompletes.length&&t.each(o.infiniteScroll.ajaxCompletes,function(t,e){"function"==typeof e&&e(f,a)})})}}),"ajaxInfiScroll"==l.tz_portfolio_plus_layout&&(t(e).scroll(function(){t(e).unbind(".infscr"),d&&t(e).scrollTop()+t(e).height()>=n.offset().top+n.height()&&(d=!1,n.infinitescroll("retrieve"))}),t(e).bind("load resize",function(){t(document).height()<=t(e).height()&&n.infinitescroll("retrieve")})),l.tz_portfolio_plus_layout&&"ajaxButton"!=l.tz_portfolio_plus_layout||(t(e).unbind(".infscr"),t("div#tz_append a").click(function(){t(this).stop(),t("div#tz_append").find("a:first").hide(),n.infinitescroll("retrieve")}))},t.tzPortfolioPlusInfiniteScroll.defaults={rootPath:"",msgText:'<i class="tz-icon-spinner tz-spin"></i><em>Loading the next set of posts...</em>',loadedText:"No more pages to load",navSelector:"#loadaj a",nextSelector:"#loadaj a:first",itemSelector:".element",dataType:"json",Itemid:null,commentText:"Comment count:",timeline:!1,sortParentTag:"#filter",sortChildTag:"a",lang:"",errorCallback:null,ajaxComplete:function(){}},t.fn.tzPortfolioPlusInfiniteScroll=function(e){void 0===e&&(e={}),"object"==typeof e&&(void 0===t(this).data("tzPortfolioPlusInfiniteScroll")?new t.tzPortfolioPlusInfiniteScroll(this,e):t(this).data("tzPortfolioPlusInfiniteScroll"))}}(jQuery,window,window.TZ_Portfolio_Plus);